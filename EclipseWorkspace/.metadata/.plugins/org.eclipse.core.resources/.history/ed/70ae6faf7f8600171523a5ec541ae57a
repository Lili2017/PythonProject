#coding=utf-8
'''
Created on 2017年8月21日

@author: LIli
'''

#import pandas as pd
import numpy as np
import xlrd
import xlwt
import os


def ReadOneExcel(filename,anglenum,djcurrentnum,phcurentnum,phspeednum,datetimenum,choosespeed):
    row_list=[]
    bk = xlrd.open_workbook(filename)
    try:
        sh = bk.sheet_by_index(0)
    except:
        print "读取excel出错"
    nrows=sh.nrows
    
    
    for i in range(1,nrows):
        
        angle=sh.row_values(anglenum-1)
        if (angle>choosespeed-0.5):
            
            
        


    


#get value by row,if celltype is datetime,read it as datemode
    for i in range(coloumnum,nrows):
        row_data = sh.row_values(i)
        row_list.append(row_data)
    print "over"
    return row_list


def CalculateData(data):
    aver=np.mean(data)
    stdva=np.std(data,ddof = 1)
    maxval=np.max(data)
    minval=np.min(data)
    return aver,stdva,maxval,minval

#获取完整路径的文件名字
def Getfilename(filefullpath):
    filename=os.path.basename(readexcelname)
    filenamewithoutex,exten=os.path.splitext(filename)
    return filenamewithoutex


def WriteExcel(writefilename,row_list):
    nwxlbook = xlwt.Workbook()   #creat a xlbook object
    sheet1 = nwxlbook.add_sheet('dregister', cell_overwrite_ok=False)
    for rn in range(0,len(row_list)):
            sheet1.write(row_list[0],row_list[1])# write(row,coloum,value)
    nwxlbook.save(writefilename)

excelname=r'C:\Users\LIli\Desktop\表格.xlsx'
readexcelname = unicode(excelname , "utf8")

rowli=[1,2,3,4]
WriteExcel(excelname,rowli)



